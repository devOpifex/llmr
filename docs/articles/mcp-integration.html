<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MCP Integration: From Development to Production ‚Ä¢ llmr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="MCP Integration: From Development to Production">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">llmr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced-workflows.html">Advanced Workflows: Conditional and Dynamic Patterns</a>
    </li>
    <li>
      <a href="../articles/get-started.html">Get Started with llmr</a>
    </li>
    <li>
      <a href="../articles/mcp-integration.html">MCP Integration: From Development to Production</a>
    </li>
    <li>
      <a href="../articles/workflow-basics.html">Workflow Basics: Linear Chains</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MCP Integration: From Development to
Production</h1>
            
      

      <div class="hidden name"><code>mcp-integration.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>Model Context Protocol (MCP)</strong> is a standardized
way to connect AI assistants with external tools and data sources. The
<strong>llmr</strong> package provides seamless integration with MCP
through the <strong>mcpr</strong> package, enabling a powerful ‚Äúlift and
shift‚Äù approach to tool development.</p>
<p>This vignette demonstrates how to take the calculator tool from the
‚ÄúGet Started‚Äù guide and deploy it as a production-ready MCP server,
while maintaining the same simple client interface.</p>
<div class="section level3">
<h3 id="what-youll-learn">What You‚Äôll Learn<a class="anchor" aria-label="anchor" href="#what-youll-learn"></a>
</h3>
<p>By the end of this guide, you‚Äôll understand how to:</p>
<ul>
<li>Transform inline tools into standalone MCP servers</li>
<li>Connect llmr agents to external MCP services</li>
<li>Leverage the ‚Äúlift and shift‚Äù approach for production
deployment</li>
<li>Scale your tool architecture from development to production</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-development-to-production-journey">The Development-to-Production Journey<a class="anchor" aria-label="anchor" href="#the-development-to-production-journey"></a>
</h3>
<div class="section level4">
<h4 id="development-phase-inline-tools">Development Phase: Inline Tools<a class="anchor" aria-label="anchor" href="#development-phase-inline-tools"></a>
</h4>
<p>In the ‚ÄúGet Started‚Äù vignette, we created a calculator tool directly
within our agent:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Development approach - tool embedded in agent</span></span>
<span><span class="va">calculator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/new_tool.html" class="external-link">new_tool</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"calculator"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Performs basic arithmetic operations"</span>,</span>
<span>  input_schema <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/schema.html" class="external-link">schema</a></span><span class="op">(</span></span>
<span>    properties <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/properties.html" class="external-link">properties</a></span><span class="op">(</span></span>
<span>      operation <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/property_enum.html" class="external-link">property_enum</a></span><span class="op">(</span></span>
<span>        <span class="st">"Operation"</span>,</span>
<span>        <span class="st">"Math operation to perform"</span>,</span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"add"</span>, <span class="st">"subtract"</span>, <span class="st">"multiply"</span>, <span class="st">"divide"</span><span class="op">)</span>,</span>
<span>        required <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span>,</span>
<span>      a <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/property_number.html" class="external-link">property_number</a></span><span class="op">(</span><span class="st">"First number"</span>, <span class="st">"First operand"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      b <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/property_number.html" class="external-link">property_number</a></span><span class="op">(</span><span class="st">"Second number"</span>, <span class="st">"Second operand"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  handler <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span></span>
<span>      <span class="va">params</span><span class="op">$</span><span class="va">operation</span>,</span>
<span>      <span class="st">"add"</span> <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">+</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span>,</span>
<span>      <span class="st">"subtract"</span> <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">-</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span>,</span>
<span>      <span class="st">"multiply"</span> <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span>,</span>
<span>      <span class="st">"divide"</span> <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">/</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://mcpr.opifex.org/reference/response.html" class="external-link">response_text</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_tool.html">add_tool</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">calculator</span><span class="op">)</span></span></code></pre></div>
<p>This approach is perfect for: - <strong>Rapid prototyping</strong> -
<strong>Testing new functionality</strong> - <strong>Simple, single-use
tools</strong></p>
</div>
<div class="section level4">
<h4 id="production-phase-mcp-servers">Production Phase: MCP Servers<a class="anchor" aria-label="anchor" href="#production-phase-mcp-servers"></a>
</h4>
<p>For production deployment, we can ‚Äúlift and shift‚Äù the same tool
logic into an MCP server:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Production approach - tool as external MCP server</span></span>
<span><span class="va">client</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/client.html" class="external-link">new_client_io</a></span><span class="op">(</span>command <span class="op">=</span> <span class="st">"Rscript"</span>, args <span class="op">=</span> <span class="st">"calculator-server.R"</span><span class="op">)</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">client</span><span class="op">)</span></span></code></pre></div>
<p>This approach provides: - <strong>Scalability</strong> - Tools run as
separate processes - <strong>Reusability</strong> - Multiple agents can
share the same tools - <strong>Maintainability</strong> - Tools can be
updated independently - <strong>Security</strong> - Tools run in
isolated environments</p>
</div>
</div>
<div class="section level3">
<h3 id="step-1-understanding-the-mcp-server">Step 1: Understanding the MCP Server<a class="anchor" aria-label="anchor" href="#step-1-understanding-the-mcp-server"></a>
</h3>
<p>Let‚Äôs transform our calculator tool into a standalone MCP server.
Here‚Äôs what the server code looks like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mcpr.opifex.org/" class="external-link">mcpr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the same calculator tool from the Get Started guide</span></span>
<span><span class="va">calculator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/new_tool.html" class="external-link">new_tool</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"calculator"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Performs basic arithmetic operations"</span>,</span>
<span>  input_schema <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/schema.html" class="external-link">schema</a></span><span class="op">(</span></span>
<span>    properties <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/properties.html" class="external-link">properties</a></span><span class="op">(</span></span>
<span>      operation <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/property_enum.html" class="external-link">property_enum</a></span><span class="op">(</span></span>
<span>        <span class="st">"Operation"</span>,</span>
<span>        <span class="st">"Math operation to perform"</span>,</span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"add"</span>, <span class="st">"subtract"</span>, <span class="st">"multiply"</span>, <span class="st">"divide"</span><span class="op">)</span>,</span>
<span>        required <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span>,</span>
<span>      a <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/property_number.html" class="external-link">property_number</a></span><span class="op">(</span><span class="st">"First number"</span>, <span class="st">"First operand"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      b <span class="op">=</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/property_number.html" class="external-link">property_number</a></span><span class="op">(</span><span class="st">"Second number"</span>, <span class="st">"Second operand"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  handler <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span></span>
<span>      <span class="va">params</span><span class="op">$</span><span class="va">operation</span>,</span>
<span>      <span class="st">"add"</span> <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">+</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span>,</span>
<span>      <span class="st">"subtract"</span> <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">-</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span>,</span>
<span>      <span class="st">"multiply"</span> <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span>,</span>
<span>      <span class="st">"divide"</span> <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">/</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://mcpr.opifex.org/reference/response.html" class="external-link">response_text</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an MCP server and add the calculator tool</span></span>
<span><span class="va">mcp_server</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/new_server.html" class="external-link">new_server</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Calculator Server"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"A production-ready calculator service"</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"1.0.0"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add the tool to the server</span></span>
<span><span class="va">mcp_server</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/add_capability.html" class="external-link">add_capability</a></span><span class="op">(</span><span class="va">mcp_server</span>, <span class="va">calculator</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Start the server (listening on stdin/stdout)</span></span>
<span><span class="fu"><a href="https://mcpr.opifex.org/reference/serve_io.html" class="external-link">serve_io</a></span><span class="op">(</span><span class="va">mcp_server</span><span class="op">)</span></span></code></pre></div>
<p><strong>Key Insight</strong>: Notice how the tool definition is
<strong>identical</strong> to the inline version. This is the power of
the ‚Äúlift and shift‚Äù approach - no code changes required!</p>
<p>The llmr package includes this exact server as a ready-to-use
example:</p>
</div>
<div class="section level3">
<h3 id="step-2-create-the-mcp-client">Step 2: Create the MCP Client<a class="anchor" aria-label="anchor" href="#step-2-create-the-mcp-client"></a>
</h3>
<p>Now let‚Äôs create an agent that connects to our MCP server:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">llmr</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'llmr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     step</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mcpr.opifex.org/" class="external-link">mcpr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'mcpr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:methods':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     initialize</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     write</span></span>
<span></span>
<span><span class="co"># Set up your provider (same as before)</span></span>
<span><span class="va">provider</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/provider.html">new_anthropic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an agent</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_agent.html">new_agent</a></span><span class="op">(</span><span class="st">"calculator"</span>, <span class="va">provider</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-connect-to-the-mcp-server">Step 3: Connect to the MCP Server<a class="anchor" aria-label="anchor" href="#step-3-connect-to-the-mcp-server"></a>
</h3>
<p>Instead of adding tools directly, we‚Äôll connect to our external MCP
server. The llmr package includes a ready-to-use calculator server:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the path to the example calculator server included with llmr</span></span>
<span><span class="va">server_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"calculator-server.R"</span>, package <span class="op">=</span> <span class="st">"llmr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an MCP client that connects to our calculator server</span></span>
<span><span class="va">calculator_client</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/client.html" class="external-link">new_client_io</a></span><span class="op">(</span></span>
<span>  command <span class="op">=</span> <span class="st">"Rscript"</span>,</span>
<span>  args <span class="op">=</span> <span class="va">server_path</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"calculator"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Register the MCP client with our agent</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">calculator_client</span><span class="op">)</span></span></code></pre></div>
<p><strong>What‚Äôs happening here:</strong> -
<code><a href="https://mcpr.opifex.org/reference/client.html" class="external-link">new_client_io()</a></code> creates a client that launches our server
as a subprocess - The server communicates via stdin/stdout (standard MCP
protocol) - <code><a href="../reference/register_mcp.html">register_mcp()</a></code> makes all server tools available
to the agent</p>
</div>
<div class="section level3">
<h3 id="step-4-use-the-agent-same-interface">Step 4: Use the Agent (Same Interface!)<a class="anchor" aria-label="anchor" href="#step-4-use-the-agent-same-interface"></a>
</h3>
<p>The beauty of this approach is that the client interface remains
<strong>exactly the same</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Same usage as the inline tool version</span></span>
<span><span class="fu"><a href="../reference/request.html">request</a></span><span class="op">(</span><span class="va">agent</span>, <span class="st">"What is 25 multiplied by 4?"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &gt; 2025-06-17 11:39:30 [TOOL] Calling MCP (calculator) tool: calculator</span></span>
<span><span class="co">#&gt; $env</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5d4d4df09f48&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $provider</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"name")</span></span>
<span><span class="co">#&gt; [1] "calculator"</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "agent"</span></span>
<span><span class="fu"><a href="../reference/get_last_message.html">get_last_message</a></span><span class="op">(</span><span class="va">agent</span><span class="op">)</span></span>
<span><span class="co">#&gt; $role</span></span>
<span><span class="co">#&gt; [1] "assistant"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $content</span></span>
<span><span class="co">#&gt; $content[[1]]</span></span>
<span><span class="co">#&gt; $content[[1]]$type</span></span>
<span><span class="co">#&gt; [1] "text"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $content[[1]]$text</span></span>
<span><span class="co">#&gt; [1] "25 multiplied by 4 equals 100."</span></span>
<span></span>
<span><span class="co"># Complex calculations work the same way</span></span>
<span><span class="fu"><a href="../reference/request.html">request</a></span><span class="op">(</span><span class="va">agent</span>, <span class="st">"I have 150 dollars, spend 47.50 on dinner and 23.75 on a book. How much is left?"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &gt; 2025-06-17 11:39:38 [TOOL] Calling MCP (calculator) tool: calculator </span></span>
<span><span class="co">#&gt; &gt; 2025-06-17 11:39:42 [TOOL] Calling MCP (calculator) tool: calculator</span></span>
<span><span class="co">#&gt; $env</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5d4d4df09f48&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $provider</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"name")</span></span>
<span><span class="co">#&gt; [1] "calculator"</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "agent"</span></span>
<span><span class="fu"><a href="../reference/get_last_message.html">get_last_message</a></span><span class="op">(</span><span class="va">agent</span><span class="op">)</span></span>
<span><span class="co">#&gt; $role</span></span>
<span><span class="co">#&gt; [1] "assistant"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $content</span></span>
<span><span class="co">#&gt; $content[[1]]</span></span>
<span><span class="co">#&gt; $content[[1]]$type</span></span>
<span><span class="co">#&gt; [1] "text"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $content[[1]]$text</span></span>
<span><span class="co">#&gt; [1] "You have $78.75 left after spending $47.50 on dinner and $23.75 on a book."</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-lift-and-shift-advantage">The ‚ÄúLift and Shift‚Äù Advantage<a class="anchor" aria-label="anchor" href="#the-lift-and-shift-advantage"></a>
</h3>
<div class="section level4">
<h4 id="development-workflow">Development Workflow<a class="anchor" aria-label="anchor" href="#development-workflow"></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Start with inline tools</strong> for rapid prototyping</li>
<li>
<strong>Test and refine</strong> your tool logic</li>
<li>
<strong>Lift the tool definition</strong> to an MCP server</li>
<li>
<strong>Shift your agent</strong> to use the MCP client</li>
<li>
<strong>Deploy to production</strong> with no client code
changes</li>
</ol>
</div>
<div class="section level4">
<h4 id="benefits-of-this-approach">Benefits of This Approach<a class="anchor" aria-label="anchor" href="#benefits-of-this-approach"></a>
</h4>
<div class="section level5">
<h5 id="scalability">üöÄ <strong>Scalability</strong><a class="anchor" aria-label="anchor" href="#scalability"></a>
</h5>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multiple agents can share the same calculator service</span></span>
<span><span class="va">agent1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_agent.html">new_agent</a></span><span class="op">(</span><span class="st">"financial_advisor"</span>, <span class="va">provider</span><span class="op">)</span></span>
<span><span class="va">agent2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_agent.html">new_agent</a></span><span class="op">(</span><span class="st">"math_tutor"</span>, <span class="va">provider</span><span class="op">)</span></span>
<span><span class="va">agent3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_agent.html">new_agent</a></span><span class="op">(</span><span class="st">"data_analyst"</span>, <span class="va">provider</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All connect to the same MCP server</span></span>
<span><span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent1</span>, <span class="va">calculator_client</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent2</span>, <span class="va">calculator_client</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent3</span>, <span class="va">calculator_client</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="reusability">üîÑ <strong>Reusability</strong><a class="anchor" aria-label="anchor" href="#reusability"></a>
</h5>
<ul>
<li>One calculator server serves multiple use cases</li>
<li>Tools become organizational assets, not agent-specific code</li>
<li>Easy to discover and share tools across teams</li>
</ul>
</div>
<div class="section level5">
<h5 id="security-isolation">üõ°Ô∏è <strong>Security &amp; Isolation</strong><a class="anchor" aria-label="anchor" href="#security-isolation"></a>
</h5>
<ul>
<li>Tools run in separate processes with controlled permissions</li>
<li>Server crashes don‚Äôt affect the main agent</li>
<li>Easy to implement resource limits and monitoring</li>
</ul>
</div>
<div class="section level5">
<h5 id="maintainability">üîß <strong>Maintainability</strong><a class="anchor" aria-label="anchor" href="#maintainability"></a>
</h5>
<ul>
<li>Update tool logic without touching agent code</li>
<li>Version control tools independently</li>
<li>Deploy tool updates without agent restarts</li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="advanced-mcp-patterns">Advanced MCP Patterns<a class="anchor" aria-label="anchor" href="#advanced-mcp-patterns"></a>
</h3>
<div class="section level4">
<h4 id="multiple-mcp-services">Multiple MCP Services<a class="anchor" aria-label="anchor" href="#multiple-mcp-services"></a>
</h4>
<p>You can connect to multiple MCP servers for different
capabilities:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Connect to different specialized services</span></span>
<span><span class="va">calculator_client</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/client.html" class="external-link">new_client_io</a></span><span class="op">(</span>command <span class="op">=</span> <span class="st">"Rscript"</span>, args <span class="op">=</span> <span class="st">"calculator-server.R"</span><span class="op">)</span></span>
<span><span class="va">weather_client</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/client.html" class="external-link">new_client_io</a></span><span class="op">(</span>command <span class="op">=</span> <span class="st">"Rscript"</span>, args <span class="op">=</span> <span class="st">"weather-server.R"</span><span class="op">)</span></span>
<span><span class="va">database_client</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/client.html" class="external-link">new_client_io</a></span><span class="op">(</span>command <span class="op">=</span> <span class="st">"Rscript"</span>, args <span class="op">=</span> <span class="st">"database-server.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Register all services with the agent</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">calculator_client</span><span class="op">)</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">weather_client</span><span class="op">)</span>  </span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">database_client</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hybrid-approach">Hybrid Approach<a class="anchor" aria-label="anchor" href="#hybrid-approach"></a>
</h4>
<p>You can mix inline tools with MCP services:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quick inline tool for simple tasks</span></span>
<span><span class="va">simple_tool</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/new_tool.html" class="external-link">new_tool</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"timestamp"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_tool.html">add_tool</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">simple_tool</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># External MCP service for complex operations</span></span>
<span><span class="va">complex_client</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mcpr.opifex.org/reference/client.html" class="external-link">new_client_io</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">complex_client</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="production-deployment-considerations">Production Deployment Considerations<a class="anchor" aria-label="anchor" href="#production-deployment-considerations"></a>
</h3>
<div class="section level4">
<h4 id="server-management">Server Management<a class="anchor" aria-label="anchor" href="#server-management"></a>
</h4>
<ul>
<li>Use process managers (systemd, Docker, etc.) for MCP servers</li>
<li>Implement health checks and automatic restarts</li>
<li>Monitor server performance and resource usage</li>
</ul>
</div>
<div class="section level4">
<h4 id="security">Security<a class="anchor" aria-label="anchor" href="#security"></a>
</h4>
<ul>
<li>Run MCP servers with minimal required permissions</li>
<li>Use network isolation where appropriate</li>
<li>Implement authentication for sensitive tools</li>
</ul>
</div>
<div class="section level4">
<h4 id="scaling">Scaling<a class="anchor" aria-label="anchor" href="#scaling"></a>
</h4>
<ul>
<li>Deploy MCP servers on separate machines for heavy workloads</li>
<li>Use load balancers for high-availability tool services</li>
<li>Implement caching for frequently-used operations</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="migration-strategy">Migration Strategy<a class="anchor" aria-label="anchor" href="#migration-strategy"></a>
</h3>
<div class="section level4">
<h4 id="phase-1-development">Phase 1: Development<a class="anchor" aria-label="anchor" href="#phase-1-development"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start with inline tools</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_tool.html">add_tool</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">my_tool</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="phase-2-testing">Phase 2: Testing<a class="anchor" aria-label="anchor" href="#phase-2-testing"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test MCP version alongside inline version</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_tool.html">add_tool</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">my_tool</span><span class="op">)</span>  <span class="co"># Keep original</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">mcp_client</span><span class="op">)</span>  <span class="co"># Add MCP version</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="phase-3-production">Phase 3: Production<a class="anchor" aria-label="anchor" href="#phase-3-production"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove inline tool, use only MCP</span></span>
<span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_mcp.html">register_mcp</a></span><span class="op">(</span><span class="va">agent</span>, <span class="va">mcp_client</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>The MCP integration in llmr provides a seamless path from development
to production:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Develop quickly</strong> with inline tools</li>
<li>
<strong>Lift tool definitions</strong> to MCP servers without code
changes</li>
<li>
<strong>Shift agents</strong> to use MCP clients with minimal
changes</li>
<li>
<strong>Scale confidently</strong> with production-ready
architecture</li>
</ol>
<p>This approach gives you the best of both worlds: the speed of inline
development and the robustness of distributed production systems.</p>
<div class="section level4">
<h4 id="key-takeaways">Key Takeaways<a class="anchor" aria-label="anchor" href="#key-takeaways"></a>
</h4>
<ul>
<li>
<strong>Same tool logic</strong> works in both inline and MCP
modes</li>
<li>
<strong>Client interface remains unchanged</strong> during
migration</li>
<li>
<strong>MCP provides production benefits</strong> without
development complexity</li>
<li>
<strong>Gradual migration</strong> is possible and recommended</li>
</ul>
<p>The Model Context Protocol integration makes llmr a powerful platform
for building scalable AI agent systems that can grow from prototype to
production seamlessly.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John Coene, Opifex.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
